<!DOCTYPE html>
<html th:replace="~{layout/baseAdmin :: html}" xmlns:th="http://www.thymeleaf.org">

<div th:fragment="contenido">
    <div class="container-fluid p-4">

        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="h2">Gestión de Fuentes</h1>
            <a th:href="@{/admin/fuentes/crear}" class="btn btn-success">
                <i class="bi bi-plus-lg me-1"></i> Nueva Fuente
            </a>
        </div>

        <div class="row mb-4">
            <div class="col-md">
                <div class="card kpi-card shadow-sm h-100">
                    <div class="card-body text-center">
                        <p class="card-subtitle text-muted mb-2">Total de Fuentes</p>
                        <p class="card-text display-6 fw-bold" th:text="${totalFuentes ?: '0'}">0</p>
                    </div>
                </div>
            </div>
            <div class="col-md">
                <div class="card kpi-card shadow-sm h-100">
                    <div class="card-body text-center">
                        <p class="card-subtitle text-muted mb-2">Estáticas (CSV)</p>
                        <p class="card-text display-6 fw-bold" th:text="${totalEstaticas ?: '0'}">0</p>
                    </div>
                </div>
            </div>
            <div class="col-md">
                <div class="card kpi-card shadow-sm h-100">
                    <div class="card-body text-center">
                        <p class="card-subtitle text-muted mb-2">Dinámicas (Usuarios)</p>
                        <p class="card-text display-6 fw-bold" th:text="${totalDinamicas ?: '0'}">0</p>
                    </div>
                </div>
            </div>
            <div class="col-md">
                <div class="card kpi-card shadow-sm h-100">
                    <div class="card-body text-center">
                        <p class="card-subtitle text-muted mb-2">Proxy (Externas)</p>
                        <p class="card-text display-6 fw-bold" th:text="${totalProxy ?: '0'}">0</p>
                    </div>
                </div>
            </div>
        </div> <div class="row">
        <div class="col-12">
            <h3 class="h4 mb-3">Fuentes Configuradas</h3>
        </div>

        <div th:if="${not #lists.isEmpty(fuentesDTO)}" class="col-12">
            <div class="row">
                <div th:each="fuente : ${fuentesDTO}" class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body d-flex flex-column">

                                <span class="badge bg-primary  align-self-end mb-2" th:text="${fuente.tipoFuente ?: 'N/A'}">TIPO</span>

                            <h5 class="card-title mb-1">Fuente ID: <span class="fw-bold" th:text="${fuente.id ?: 'N/A'}">ID</span></h5>

                            <p class="card-text text-muted small flex-grow-1">
                                URL Base: <br>
                                <code class="d-block" style="word-break: break-all;" th:text="${fuente.baseUrl}">http://...</code>
                            </p>

                            <div class="mt-auto d-flex gap-2 justify-content-end">
                                <a class="btn btn-sm btn-outline-success" th:href="@{/admin/fuentes/{id}(id=${fuente.id})}">Editar</a>
                                <form th:action="@{/admin/fuentes/eliminar/{id}(id=${fuente.id})}" method="POST" onsubmit="return confirm('¿Estás seguro de que quieres eliminar esta fuente?');">
                                    <button class="btn btn-sm btn-outline-danger" type="submit">
                                        <i class="bi bi-trash me-1"></i> Eliminar
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> <div th:if="${#lists.isEmpty(fuentesDTO)}" class="col-12">
        <div class="alert alert-secondary text-center" role="alert">
            No hay fuentes configuradas todavía.
        </div>
    </div>

    </div> </div> </div>
</html>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
<link rel="stylesheet" th:href="@{/css/styles.css}">
<!--
<html th:replace="~{layout/baseAdmin :: html}">
<div th:fragment="contenido">
    <h2 class="ms-5">Fuentes</h2>
    <table class="table table-sm table-dark">
        <thead>
        <tr>
            <th scope="col">Fuente URL</th>
            <th scope="col">Tipo Fuente</th>
            <th scope="col"></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="fuente : ${fuentesDTO}">
            <td scope="row" th:text="${fuente.baseUrl}"/>
            <td th:text="${fuente.tipoFuente}"/>
            <td><a class="navbar-brand" th:href="@{/admin/fuentes/{id}(id=${fuente.id})}">Editar</a></td>
        </tr>
        </tbody>
    </table>
</div>
</html>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
<link rel="stylesheet" th:href="@{/css/landing.css}">
-->